
<html>
<head>

    <meta charset="utf-8">
    <title>JavaScript获取客户端IP[利用新浪接口] - www.jbxue.com </title>
</head>
<body>
<script type="text/javascript" src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
<script type="text/javascript">
        alert(returnCitySN.cip)
</script>
<script type="text/javascript">
   document.write(getLocalIPAddress());
    function getLocalIPAddress()
    {
        var obj = null;
        var rslt = "127.0.0.2";
        try
        {
            obj = new ActiveXObject("rcbdyctl.Setting");
            if (!isNull(obj.GetIPAddress))
            {
                rslt = obj.GetIPAddress;
            }
            obj = null;
        }
        catch(e)
        {
            //异常发生
        }

        return rslt;
    }
</script>
</body>
</html> 